{%- if page.bluesky_post_uri and jekyll.environment == "production" -%}
<link rel="stylesheet" href="https://unpkg.com/@bluesky-social/bluesky-comments@0.1.0/dist/bluesky-comments.css">
<!-- Add this new importmap before any other scripts -->
<script type="importmap">
  {
    "imports": {
      "react": "https://esm.sh/react@18",
      "react-dom": "https://esm.sh/react-dom@18"
    }
  }
</script>
<!-- Add this new module script -->
<script type="module">
  import {BlueskyComments} from 'https://unpkg.com/@bluesky-social/bluesky-comments@0.1.0/dist/bluesky-comments.es.js';
  document.addEventListener('DOMContentLoaded', function() {
    const uri = '{{page.bluesky_post_uri}}';
    const author = '{{site.bluesky_handle}}';
    BlueskyComments.init('bluesky-comments', {
      uri,
      author,
      commentFilters: [BlueskyComments.Filters.NoPins],
    });
  });
</script>
{%- endif -%} 